!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.photoswippy=t()}(this,function(){"use strict";var e,t,o,n,r=function(e){return Array.prototype.slice.call(e)},i=function(e,t){return e&&(t(e)?e:i(e.parentNode,t))},a=function(e,t,o){var n=new Image;n.onload=function(){return t(n)},o&&(n.onerror=function(){return o(n)}),n.src=e},p=function(e){for(var t=0;e=e.previousElementSibling;)++t;return t},s=function(e,t){return(Element.prototype.matches||Element.prototype.webkitMatchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector).call(e,t)},l=function(){return window.location.hash.substring(1).split("&").reduce(function(e,t){if(t.length){var o=t.split("="),n=o[0],r=o[1];e[n]=r}return e},{})},c=Object.assign||function(e){var t=arguments;if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var o=Object(e),n=1;n<arguments.length;n++){var r=t[n];if(null!=r)for(var i in r)r.hasOwnProperty(i)&&(o[i]=r[i])}return o},u=0,d={},f={indexSelector:null,itemSelector:"a",captionSelector:"figcaption",hoverPreload:!1,useMsrc:!0},w=function(o,r,i){i=i||o.items[r].el.querySelector("img")||{offsetWidth:0,offsetHeight:0};var p=c({},o.options,{index:r,getThumbBoundsFn:function(e){var t=o.items[e].el.offsetParent?o.items[e].el:i;if(t.offsetParent){var n=window.pageYOffset||document.documentElement.scrollTop,r=t.getBoundingClientRect();return{x:r.left,y:r.top+n,w:r.width}}}}),s=new e(n,t,o.items,p);s.listen("gettingData",function(e,t){t.w&&t.h||(t.w=i.offsetWidth,t.h=i.offsetHeight,p.hoverPreload&&t.preloadState||a(t.src,function(e){t.w=e.width,t.h=e.height,s.updateSize(!0)}))}),s.init()},h=function(e){return function(t){t.preventDefault();var o=i(t.target,function(t){return 1===t.nodeType&&s(t,e.options.itemSelector)});if(o){var n=i(o,"string"==typeof e.options.indexSelector?function(t){return s(t,e.options.indexSelector)}:function(t){return t.parentNode===e.el}),r=p(n);w(e,r,o)}}},v=function(e,t){if(void 0===t&&(t={}),e.dataset.pswpOptions)t=JSON.parse(e.dataset.pswpOptions);else{var n=Object.keys(e.dataset).filter(function(e){return 0===e.indexOf("pswp")&&"pswp"!==e});n.length>0&&n.forEach(function(o){var n=o[4].toLowerCase()+o.substring(5);t[n]=e.dataset[o]||!0})}var i=c({galleryUID:e.dataset.pswpId||e.dataset.pswp||"gallery-"+u},o,t);e.dataset.pswp=i.galleryUID;var p=r(e.querySelectorAll(i.itemSelector)).map(function(e){var t=e.querySelector(i.captionSelector)||{},o=(e.dataset.pswpSize||"").toLowerCase().split("x").map(parseInt),n=o[0],r=o[1],p=n||e.dataset.pswpWidth||0,s=r||e.dataset.pswpHeight||0,l=e.dataset.pswpCaption||t.innerHTML||"",c=e.dataset.pswpSrc||e.href,u={el:e,src:c,w:p,h:s,title:l};if(i.useMsrc){var d=e.querySelector("img");d&&(u.msrc=d.src)}return i.hoverPreload&&e.addEventListener("mouseover",function t(o){u.preloadState||(u.preloadState=1,a(c,function(o){u.preloadState=2,u.w=o.width,u.h=o.height,e.removeEventListener("mouseover",t)},function(){u.preloadState=0,e.removeEventListener("mouseover",t)}))}),u}),s={el:e,options:i,items:p};return e.addEventListener("click",h(s)),s},m=function(o,n){if(e&&t||console.error('[PhotoSwippy] PhotoSwipe and PhotoSwipeUI libraries were not found. Was "PhotoSwippy.init()" called?'),o){("string"==typeof o?r(document.querySelectorAll(o)):[o]).forEach(function(e){if(!e.photoswippy){u++;var t=v(e,n);e.photoswippy=!0,d[t.options.galleryUID]=t}});var i=l();i.pid&&i.gid&&d[i.gid]&&w(d[i.gid],i.pid-1,null),y()}},y=function(){r(document.querySelectorAll("[data-pswp-trigger]")).forEach(function(e){e.photoswippy||(e.photoswippy=!0,e.addEventListener("click",function(){var e=this.dataset.pswpTrigger.split("@"),t=e[0],o=e[1];void 0===o&&(o=0);var n=d[t];n?w(n,parseInt(o),this):console.error("[PhotoSwippy] Gallery with id '"+t+"' not found.")}))})};return{init:function(r,i,a){void 0===r&&(r=window.PhotoSwipe),void 0===i&&(i=window.PhotoSwipeUI_Default),e=r,t=i,o=c(f,a),(n=document.querySelector(".pswp"))||console.error("[PhotoSwippy] Photoswipe template (Element with .pswp class) not found."),m("[data-pswp]")},build:m}});
