!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.photoswippy=t()}(this,function(){"use strict";var e,t,o,n,i=0,r={},a=function(e){return Array.prototype.slice.call(e)},p=function(e,t){return e&&(t(e)?e:p(e.parentNode,t))},l=Object.assign||function(e){var t=arguments;if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var o=Object(e),n=1;n<arguments.length;n++){var i=t[n];if(null!=i)for(var r in i)i.hasOwnProperty(r)&&(o[r]=i[r])}return o},s=function(e,t){return(Element.prototype.matches||Element.prototype.webkitMatchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector).call(e,t)},c=function(e){for(var t=0;e=e.previousElementSibling;)++t;return t},u=function(o,i,r){r=r||o.items[i].el.offsetParent&&o.items[i].el.getElementsByTagName("img")[0];var a=l({},o.options,{index:i,getThumbBoundsFn:function(e){if(r){var t=window.pageYOffset||document.documentElement.scrollTop,o=r.getBoundingClientRect();return{x:o.left,y:o.top+t,w:o.width}}}}),p=new e(n,t,o.items,a);p.listen("gettingData",function(e,t){if(!t.w||!t.h){var o=t.el.getElementsByTagName("img")[0];o&&(t.w=o.width,t.h=o.height);var n=new Image;n.onload=function(){t.w=this.width,t.h=this.height,p.updateSize(!0)},n.src=t.src}}),p.init()},d=function(e){return function(t){(t=t||window.event).preventDefault?t.preventDefault():t.returnValue=!1;var o=p(t.target||t.srcElement,function(t){return 1===t.nodeType&&s(t,e.options.itemSelector)});if(o){for(var n=o;n.parentNode!==e.el;)n=n.parentNode;u(e,c(n),o)}}},f=function(e,t){i++;var n=e.dataset.pswpOptions;null!=n&&""!==n&&(t=JSON.parse(n));var r=l({galleryUID:e.dataset.pswpId||e.dataset.pswp||"gallery-"+i},o,t);e.dataset.pswp=r.galleryUID;var p=a(e.querySelectorAll(r.itemSelector)).map(function(e){var t=(e.dataset.pswpSize||"").toLowerCase().split("x"),o=t[0],n=t[1],i=e.querySelector(r.captionSelector),a=e.getElementsByTagName("img")[0];return{el:e,src:e.dataset.pswpSrc||e.href,w:o||e.dataset.pswpWidth||0,h:n||e.dataset.pswpHeight||0,title:e.dataset.pswpCaption||i&&i.innerHTML||a&&a.alt||""}});return{el:e,options:r,items:p}},w=function(){var e=window.location.hash.substring(1).split("&").reduce(function(e,t){if(t.length){var o=t.split("="),n=o[0],i=o[1];e[n]=i}return e},{});e.pid&&e.gid&&r[e.gid]&&u(r[e.gid],e.pid-1)},h=function(){a(document.querySelectorAll("[data-pswp-trigger]")).forEach(function(e){e.photoswippy||(e.photoswippy=!0,e.addEventListener("click",function(){var e=r[this.dataset.pswpTrigger];e?u(e,0,this):console.error("[PhotoSwippy] Gallery with id '"+this.dataset.pswpTrigger+"' not found.")}))})},g=function(o,n){e&&t||console.error('[PhotoSwippy] PhotoSwipe and PhotoSwipeUI libraries were not found. Was "PhotoSwippy.init()" called?'),o&&(("string"==typeof o?a(document.querySelectorAll(o)):[o]).forEach(function(e){if(!e.photoswippy){var t=f(e,n);e.photoswippy=!0,e.addEventListener("click",d(t)),r[t.options.galleryUID]=t}}),w(),h())};return{init:function(i,r,a){void 0===i&&(i=window.PhotoSwipe),void 0===r&&(r=window.PhotoSwipeUI_Default),e=i,t=r,o=l({itemSelector:"a",captionSelector:"figcaption"},a),(n=document.querySelector(".pswp"))||console.error("[PhotoSwippy] Photoswipe template (Element with .pswp class) not found."),g("[data-pswp]")},build:g}});
